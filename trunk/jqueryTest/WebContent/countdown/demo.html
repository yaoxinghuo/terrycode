<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />  
</head>
<body>
<h1>测试1：</h1>
<button id="start" >开始&&重新开始</button>
<button id="pause" >暂停</button>
<button id="again" >暂停后 重新开始</button>
<div id="test" ></div>

<br/>
<h1>测试2：</h1>
<button id="start2" >开始&&重新开始</button>
<button id="pause2" >暂停</button>
<button id="again2" >暂停后 重新开始</button>
<div id="test2" ></div>

<br/><br/>
Dev by cssrain

<script type="text/javascript" src="../js/jquery-1.3.2.min.js"></script>
<script>
	
jQuery.cookie = function(name, value, options) {
    if (typeof value != 'undefined') { // name and value given, set cookie
        options = options || {};
        if (value === null) {
            value = '';
            options.expires = -1;
        }
        var expires = '';
        if (options.expires && (typeof options.expires == 'number' || options.expires.toUTCString)) {
            var date;
            if (typeof options.expires == 'number') {
                date = new Date();
                date.setTime(date.getTime() + (options.expires * 24 * 60 * 60 * 1000));
            } else {
                date = options.expires;
            }
            expires = '; expires=' + date.toUTCString(); // use expires attribute, max-age is not supported by IE
        }
        var path = options.path ? '; path=' + options.path : '';
        var domain = options.domain ? '; domain=' + options.domain : '';
        var secure = options.secure ? '; secure' : '';
        document.cookie = [name, '=', encodeURIComponent(value), expires, path, domain, secure].join('');
    } else { // only name given, get cookie
        var cookieValue = null;
        if (document.cookie && document.cookie != '') {
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++) {
                var cookie = jQuery.trim(cookies[i]);
                // Does this cookie string begin with the name we want?
                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
};

jQuery.fn.countDown = function(settings,to) {
	if(!to && to != settings.endNumber) {
		if($.cookie('to')){
			to=$.cookie('to');
		}
		else{
			to = settings.startNumber; 
		}
	}
	$.cookie('to',to);
	this.data("CR_currentTime",to);
	$(this).text(to).animate({"none":"none"},settings.duration,'',function() {
		if(to > settings.endNumber + 1) {
			$(this).countDown(settings,to - 1);
		}else{
			$.cookie('to',null);
			settings.callBack(this);
		}
	});		
	return this;
};
//计时&&重新计时
jQuery.fn.CRcountDown = function(settings) {
	settings = jQuery.extend({
		startNumber: 10,
		endNumber: 0,
		duration: 1000,
		callBack: function() { }
	}, settings);
	this.data("CR_duration",settings.duration);
	this.data("CR_endNumber",settings.endNumber);
	this.data("CR_callBack",settings.callBack);
	return this.stop().countDown(settings);
};
//计时暂停
jQuery.fn.pause = function(settings) {
	return this.stop();
};
//暂停后，重新开始
jQuery.fn.reStart = function() {
	return this.pause().CRcountDown({
		startNumber : this.data("CR_currentTime"),
		duration : 	this.data("CR_duration"),
		endNumber : this.data("CR_endNumber"),
		callBack : this.data("CR_callBack")
	});
};




/*****  测试1  ****/
// 开始 && 重新开始
$("#start").click(function(){
	$("#test").CRcountDown({
				startNumber:15,
				callBack:test
			})
			.css("color","red");
});
// 暂停
$("#pause").click(function(){
	$("#test").pause();
});
// 暂停后 重新开始
$("#again").click(function(){
	$("#test").reStart();
});
function test(){
	$("<p>计时1结束!</p>")
			  .hide()
			  .fadeIn(1000)
			  .appendTo("body");
}

/*****  测试2  ****/
// 开始 && 重新开始
$("#start2").click(function(){
	$("#test2").CRcountDown({
				startNumber:10,
				callBack:test2
			})
			.css("color","blue");
});
// 暂停
$("#pause2").click(function(){
	$("#test2").pause();
});
// 暂停后 重新开始
$("#again2").click(function(){
	$("#test2").reStart();
});
function test2(){
	$("<p>计时2结束!</p>")
			  .hide()
			  .fadeIn(1000)
			  .appendTo("body");
}
</script>
</body>
</html>