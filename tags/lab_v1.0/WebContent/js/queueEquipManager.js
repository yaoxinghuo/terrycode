function initQueueEquipManager(E,G){Ext.getDom("queue-eq-content").innerTHML="";var F=null;var D=null;var B=new Ext.data.DWRJsonReader({totalProperty:"results",root:"rows"},new Ext.data.Record.create([{name:"id",mapping:"id"},{name:"input",mapping:"input"},{name:"equip_id",mapping:"equip_id"},{name:"equip_name",mapping:"equip_name"},{name:"equip_no",mapping:"equip_no"},{name:"user_name",mapping:"user_name"},{name:"user_id",mapping:"user_id"},{name:"start",mapping:"start"},{name:"end",mapping:"end"},{name:"expired",mapping:"expired"},{name:"action",mapping:"action"},{name:"content",mapping:"content"},{name:"remark",mapping:"remark"},{name:"sample",mapping:"sample"},{name:"teacher",mapping:"teacher"},{name:"exp_time",mapping:"exp_time"},{name:"fee",mapping:"fee"}]));D=new Ext.data.Store({proxy:new Ext.data.DWRProxy({dwrFunction:Book.getBooksInfoByEquipId,listeners:{beforeload:function(I,J){J[I.loadArgsKey]=[J.start,J.limit,E]}}}),reader:B});var A=new Ext.grid.ColumnModel([new Ext.grid.RowNumberer(),{header:"填写日期",width:100,sortable:true,dataIndex:"input"},{header:"设备名称",width:100,sortable:true,hidden:true,dataIndex:"equip_name"},{header:"设备编号",width:100,sortable:true,hidden:true,dataIndex:"equip_no"},{header:"申请人",width:80,sortable:true,dataIndex:"user_name"},{header:"导师",width:80,sortable:true,dataIndex:"teacher"},{header:"审批情况",width:80,sortable:true,dataIndex:"action",renderer:function(I){if(I==0){return"<font color=blue>待批准</font>"}else{if(I==2){return"<font color=red>已删除</font>"}else{return"<font color=green>已批准</font>"}}}},{header:"起始日期",width:100,sortable:true,dataIndex:"start"},{header:"中止日期",width:100,sortable:true,dataIndex:"end"},{header:"实验时长",width:60,sortable:true,dataIndex:"exp_time"},{header:"是否过期",width:70,sortable:true,dataIndex:"expired",renderer:function(I){if(I){return"<font color='red'>是</font>"}else{return"<font color='green'>否</font>"}}},{header:"样品/数量",width:105,sortable:true,dataIndex:"sample"},{header:"预约内容",width:150,sortable:true,dataIndex:"content"},{header:"实验/应收费用",width:150,sortable:true,dataIndex:"fee"},{header:"费用备注",width:150,sortable:true,dataIndex:"remark"}]);F=new Ext.grid.GridPanel({id:"queue-equip",title:"设备预约列表",border:false,store:D,renderTo:"queue-eq-content",header:false,cm:A,loadMask:true,iconCls:"tabs",closable:true,tbar:[{text:"刷新",tooltip:"刷新",iconCls:"refresh",onClick:function(){D.reload()}},"-",{text:"显示设备'<font color=red>"+G+"</font>'的预约列表",xtype:"tbtext"}],bbar:new Ext.PagingToolbar({pageSize:pageSize,store:D,displayInfo:true})});var H=new Ext.menu.Menu({id:"queueequiprightClickCont",items:[{id:"queueequipMessageMenu",handler:C,iconCls:"view",text:"查看预约内容"}]});F.addListener("rowcontextmenu",function(J,I,K){K.preventDefault();J.getSelectionModel().selectRow(I);H.showAt(K.getXY())});D.load({params:{start:0,limit:pageSize}});tabPanel.add(F).show();function C(){var I=F.getSelectionModel().getSelected();if(!I){return }if(!islogin){showMsg("该操作需要<a href='#' onclick='showLoginWin();return false;'>登录</a>后才能继续！");return }DWRUtil.useLoadingMessage("处理中...");Book.messageBook(I.data.id,{callback:function(J){cancelLoadingMessage();Ext.MessageBox.show({title:"查看预约内容",msg:"以下显示预约内容",width:350,buttons:Ext.MessageBox.OK,multiline:true,value:J})},errorHandler:function(J){Ext.Msg.alert("错误","对不起，程序出现错误!");cancelLoadingMessage()}})}}function showQueueEquip(C,A){var B=tabPanel.getItem("queue-eq-content");if(B){tabPanel.remove(B)}B=addQueueTab(C,A);tabPanel.setActiveTab(B);if(currentMsgBox!=null){currentMsgBox.hide()}};